<!DOCTYPE html>
<html>
<head>
    <!-- Add your CSS and JS includes here -->
    <!-- For example, include Bootstrap CSS and JavaScript -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <title>Pu Result Fetcher</title>
    <style>
        .footer {
            background-color: #f8f9fa;
            padding: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
       <h1 class="display-4">PU Result Fetcher ( Developed in Django)</h1>
        <form id="student-form">
            <div class="form-group">
                <label for="roll_no">Enter Roll No:</label>
                <input type="text" class="form-control" id="roll_no" name="roll_no">
            </div>
            <button type="button" class="btn btn-primary" id="get_student_button">Get Student</button>
        </form>

        <div id="student-info" style="display: none;">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Student Information:</h5>
                    <table class="table table-bordered">
                        <tbody>
                            <tr>
                                <th>Name</th>
                                <td id="student-name"></td>
                            </tr>
                            <tr>
                                <th>Father Name</th>
                                <td id="father-name"></td>
                            </tr>
                              <tr>
                              <th>Roll No.</th>
                                <td id="roll"></td>
                            </tr>
                            <tr>
                                <th>Registration Number</th>
                                <td id="reg-no"></td>
                            </tr>
                            <tr>
                                <th>Degree</th>
                                <td id="degree"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="results-area" style="display: none;">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Result Info:</h5>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Semester</th>
                                <th>Credit</th>
                                <th>Result</th>
                                <th>Comparts</th>
                                <th>Status</th>
                                <th>CGPA</th>
                                
                            </tr>
                        </thead>
                        <tbody id="results-table-body">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
<footer class="footer">
        <div class="container">
            <p>&copy; 2023 MS Devs. All Rights Reserved.</p>
        </div>
    </footer>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const getStudentButton = document.getElementById("get_student_button");

            getStudentButton.addEventListener("click", function() {
                getResult();
            });
        });

        function getResult() {
            const rollNo = document.querySelector("#roll_no").value;

            // Make an AJAX request to the Django view
            $.ajax({
                url: `/get_student/?roll_no=${rollNo}`,
                method: "GET",
                dataType: "json",
                success: function(data) {
                    // Separate student information
                    document.getElementById("student-name").textContent = data.results[0].name;
                    document.getElementById("father-name").textContent = data.results[0].father_name;
                  document.getElementById("roll").textContent = data.results[0].roll_no;
                    document.getElementById("reg-no").textContent = data.results[0].reg_no;
                    document.getElementById("degree").textContent = data.results[0].degree;

                    // Handle the response data here
                    // You can update the UI with the received data
                    const resultsTableBody = document.getElementById("results-table-body");
                    resultsTableBody.innerHTML = ""; // Clear existing table data

                    // Iterate through the results and create table rows
                    data.results.forEach(result => {
                        const row = document.createElement("tr");
                        row.innerHTML = `
                            <td>${result.semester}</td>
                            <td>${result.credit}</td>
                            
                            
                            
                            <td>${result.result}</td>
                            <td>${result.comparts.length > 0 ? result.comparts.map(([subject, score]) => `${subject}: ${score}`).join(", ") : ""}</td>
                            <td>${result.status}</td>
                            <td>${result.cgpa}</td>
                            
                        `;

                        resultsTableBody.appendChild(row);
                    });

                    // Show the student information and results area
                    const studentInfo = document.getElementById("student-info");
                    const resultsArea = document.getElementById("results-area");
                    studentInfo.style.display = "block";
                    resultsArea.style.display = "block";
                },
                error: function(error) {
                    console.error("Error:", error);
                    alert("Error: " + error.responseText);
                }
            });
        }
    </script>
</body>
</html>
